title: Data Exfiltration to Cloud Storage Services
id: 33334444-2222-cccc-2222-222222222222
status: stable
description: |
    Detects data exfiltration attempts using cloud storage services and
    file sharing platforms. Attackers abuse legitimate services like
    Mega, Dropbox, Google Drive, and others to exfiltrate data while
    blending with normal traffic.
references:
    - https://attack.mitre.org/techniques/T1567/002/
    - https://attack.mitre.org/techniques/T1048/
author: Defensive Toolkit
date: 2025-11-26
modified: 2025-11-26
tags:
    - attack.exfiltration
    - attack.t1567.002
    - attack.t1048
    - detection.emerging_threats
logsource:
    category: process_creation
    product: windows
detection:
    selection_mega_cli:
        Image|endswith:
            - '\MEGAcmd.exe'
            - '\mega-cmd.exe'
            - '\megacopy.exe'
        CommandLine|contains:
            - 'put'
            - 'upload'
            - 'sync'
    selection_rclone:
        Image|endswith: '\rclone.exe'
        CommandLine|contains:
            - 'copy'
            - 'sync'
            - 'move'
            - ':/'
    selection_cloud_cli:
        CommandLine|contains:
            - 'gsutil cp'
            - 'aws s3 cp'
            - 'aws s3 sync'
            - 'azcopy'
            - 'az storage blob upload'
    selection_powershell_upload:
        Image|endswith:
            - '\powershell.exe'
            - '\pwsh.exe'
        CommandLine|contains:
            - 'Invoke-WebRequest'
            - 'Invoke-RestMethod'
            - 'WebClient'
            - 'UploadFile'
            - 'UploadData'
            - 'POST'
        CommandLine|contains:
            - 'mega.nz'
            - 'dropbox.com'
            - 'drive.google.com'
            - 'transfer.sh'
            - 'file.io'
            - 'wetransfer.com'
            - 'sendspace.com'
            - 'mediafire.com'
    selection_curl_upload:
        Image|endswith:
            - '\curl.exe'
            - '\wget.exe'
        CommandLine|contains:
            - '--upload-file'
            - '-T '
            - '--data-binary'
            - 'transfer.sh'
            - 'file.io'
    condition: 1 of selection_*
falsepositives:
    - Legitimate cloud backup operations
    - Authorized file sharing
    - Development and CI/CD pipelines
level: medium
