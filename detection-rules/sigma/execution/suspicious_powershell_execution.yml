title: Suspicious PowerShell Execution with Encoded Commands
id: 12345678-1234-1234-1234-123456789abc
status: stable
description: Detects PowerShell execution with encoded commands, often used by attackers to obfuscate malicious payloads
references:
    - https://attack.mitre.org/techniques/T1059/001/
    - https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_powershell_exe
author: Defensive Toolkit
date: 2025-10-15
modified: 2025-10-15
tags:
    - attack.execution
    - attack.t1059.001
    - attack.defense_evasion
    - attack.t1027
logsource:
    category: process_creation
    product: windows
detection:
    selection_powershell:
        - Image|endswith:
            - '\powershell.exe'
            - '\pwsh.exe'
        - OriginalFileName:
            - 'PowerShell.EXE'
            - 'pwsh.dll'
    selection_encoded:
        CommandLine|contains:
            - '-enc '
            - '-EncodedCommand '
            - '-ec '
    condition: all of selection_*
falsepositives:
    - Legitimate administrative scripts using encoded commands
    - Software deployment tools
    - Configuration management systems
level: medium
