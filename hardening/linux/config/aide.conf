# AIDE Configuration - File Integrity Monitoring
# Advanced Intrusion Detection Environment

# Database locations
database=file:/var/lib/aide/aide.db
database_out=file:/var/lib/aide/aide.db.new
database_new=file:/var/lib/aide/aide.db.new

# Gzip databases
gzip_dbout=yes

# Report format
report_url=file:/var/log/aide/aide.log
report_url=stdout

# Custom rules
# p:  permissions
# i:  inode
# n:  number of links
# u:  user
# g:  group
# s:  size
# m:  mtime
# a:  atime
# c:  ctime
# S:  check for growing size
# md5: md5 checksum
# sha256: sha256 checksum

# Define custom rules
NORMAL = p+i+n+u+g+s+m+c+md5+sha256
DIR = p+i+n+u+g
DATAONLY = p+n+u+g+s+m+c+md5+sha256
LSPP = p+i+n+u+g+s+m+c+md5+sha256+xattrs
PERMS = p+i+n+u+g

# Directories to monitor

# Critical system files
/boot   NORMAL
/lib    NORMAL
/lib64  NORMAL
/bin    NORMAL
/sbin   NORMAL
/usr/bin    NORMAL
/usr/sbin   NORMAL
/usr/lib    NORMAL
/usr/lib64  NORMAL

# Configuration files
/etc    PERMS

# Logs (check for size changes)
!/var/log
!/var/cache
!/var/tmp

# Exclude temporary and variable data
!/tmp
!/proc
!/sys
!/dev
!/run
!/var/run
!/var/lock

# Critical configuration files to monitor closely
/etc/passwd NORMAL
/etc/shadow NORMAL
/etc/group NORMAL
/etc/gshadow NORMAL
/etc/sudoers NORMAL
/etc/ssh/sshd_config NORMAL
/etc/pam.d NORMAL

# Kernel and bootloader
/boot/grub NORMAL
/boot/grub2 NORMAL

# Cron jobs
/etc/cron.d NORMAL
/etc/cron.daily NORMAL
/etc/cron.hourly NORMAL
/etc/cron.monthly NORMAL
/etc/cron.weekly NORMAL
/var/spool/cron NORMAL

# Systemd
/etc/systemd NORMAL
/lib/systemd NORMAL
/usr/lib/systemd NORMAL
