title: Azure Key Vault Secret Mass Access or Modification
id: b2c3d4e5-2222-4000-8000-000000000005
status: stable
description: |
    Detects suspicious access patterns to Azure Key Vault secrets including
    bulk retrieval, deletion, or modification of secrets. Key Vaults contain
    sensitive credentials and their compromise can lead to widespread access.
references:
    - https://attack.mitre.org/techniques/T1552/001/
    - https://docs.microsoft.com/en-us/azure/key-vault/general/security-features
    - https://www.wiz.io/blog/key-vault-token-theft
author: Defensive Toolkit
date: 2025-12-28
modified: 2025-12-28
tags:
    - attack.credential_access
    - attack.t1552.001
    - detection.cloud_threats
    - cloud.azure
logsource:
    product: azure
    service: activitylogs
detection:
    selection_secret_operations:
        operationName|startswith: MICROSOFT.KEYVAULT/VAULTS/SECRETS
        operationName|contains:
            - write
            - delete
            - purge
            - backup
            - restore
    selection_key_operations:
        operationName|startswith: MICROSOFT.KEYVAULT/VAULTS/KEYS
        operationName|contains:
            - write
            - delete
            - import
            - purge
    selection_certificate_operations:
        operationName|startswith: MICROSOFT.KEYVAULT/VAULTS/CERTIFICATES
        operationName|contains:
            - write
            - delete
            - import
            - purge
    selection_vault_access_policy:
        operationName:
            - MICROSOFT.KEYVAULT/VAULTS/ACCESSPOLICIES/WRITE
            - MICROSOFT.KEYVAULT/VAULTS/WRITE
    condition: selection_secret_operations or selection_key_operations or selection_certificate_operations or selection_vault_access_policy
falsepositives:
    - Key rotation automation
    - Certificate renewal processes
    - Legitimate secret management by DevOps
level: medium
