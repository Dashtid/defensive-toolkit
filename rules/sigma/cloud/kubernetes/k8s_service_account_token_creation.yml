title: Kubernetes Service Account Token Created
id: d4e5f6a7-4444-4000-8000-000000000005
status: stable
description: |
    Detects creation of long-lived service account tokens or token requests.
    In Kubernetes 1.24+, tokens are no longer auto-created, so manual token
    creation may indicate attempts to establish persistent access.
references:
    - https://attack.mitre.org/techniques/T1078/
    - https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/
    - https://kubernetes.io/docs/reference/access-authn-authz/service-accounts-admin/
author: Defensive Toolkit
date: 2025-12-28
modified: 2025-12-28
tags:
    - attack.persistence
    - attack.credential_access
    - attack.t1078
    - detection.cloud_threats
    - cloud.kubernetes
logsource:
    product: kubernetes
    service: audit
detection:
    selection_token_request:
        verb: create
        objectRef.resource: serviceaccounts
        objectRef.subresource: token
    selection_secret_token:
        verb: create
        objectRef.resource: secrets
        requestObject.type: kubernetes.io/service-account-token
    selection_long_expiration:
        requestObject.spec.expirationSeconds|gte: 86400
    selection_default_sa:
        objectRef.name: default
    filter_system_users:
        user.username|startswith:
            - system:serviceaccount:kube-system
            - system:kube-controller-manager
    condition: (selection_token_request or selection_secret_token) and not filter_system_users
falsepositives:
    - Legitimate token creation for service accounts
    - CI/CD service account setup
    - Third-party integrations requiring tokens
level: medium
