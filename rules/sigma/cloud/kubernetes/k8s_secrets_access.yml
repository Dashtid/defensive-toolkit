title: Kubernetes Secrets Enumeration or Mass Access
id: d4e5f6a7-4444-4000-8000-000000000002
status: stable
description: |
    Detects suspicious access to Kubernetes secrets including listing all secrets,
    accessing secrets in multiple namespaces, or accessing sensitive secret names.
    This could indicate credential harvesting by an attacker.
references:
    - https://attack.mitre.org/techniques/T1552/007/
    - https://kubernetes.io/docs/concepts/configuration/secret/
    - https://microsoft.github.io/Threat-Matrix-for-Kubernetes/techniques/List%20K8S%20secrets/
author: Defensive Toolkit
date: 2025-12-28
modified: 2025-12-28
tags:
    - attack.credential_access
    - attack.t1552.007
    - detection.cloud_threats
    - cloud.kubernetes
logsource:
    product: kubernetes
    service: audit
detection:
    selection_list_secrets:
        verb: list
        objectRef.resource: secrets
    selection_get_secrets:
        verb: get
        objectRef.resource: secrets
    selection_watch_secrets:
        verb: watch
        objectRef.resource: secrets
    selection_all_namespaces:
        objectRef.namespace: ''
    selection_sensitive_names:
        objectRef.name|contains:
            - token
            - password
            - credential
            - key
            - cert
            - tls
            - auth
            - api-key
            - service-account
    filter_controllers:
        user.username|contains:
            - system:serviceaccount:kube-system
            - system:kube-controller-manager
            - system:kube-scheduler
    condition: (selection_list_secrets and selection_all_namespaces) or (selection_get_secrets and selection_sensitive_names) or (selection_watch_secrets and not filter_controllers)
falsepositives:
    - Legitimate secret management by cluster operators
    - Backup systems accessing secrets
    - GitOps tools (ArgoCD, Flux)
level: medium
