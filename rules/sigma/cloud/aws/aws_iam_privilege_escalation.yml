title: AWS IAM Privilege Escalation Attempt
id: a1b2c3d4-1111-4000-8000-000000000001
status: stable
description: |
    Detects attempts to escalate privileges in AWS through IAM policy modifications,
    role assumptions, or permission boundary changes. These techniques are commonly
    used by attackers after initial access to gain higher privileges.
references:
    - https://attack.mitre.org/techniques/T1098/
    - https://attack.mitre.org/techniques/T1078/004/
    - https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/
    - https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies.html
author: Defensive Toolkit
date: 2025-12-28
modified: 2025-12-28
tags:
    - attack.privilege_escalation
    - attack.persistence
    - attack.t1098
    - attack.t1078.004
    - detection.cloud_threats
    - cloud.aws
logsource:
    product: aws
    service: cloudtrail
detection:
    selection_attach_policy:
        eventSource: iam.amazonaws.com
        eventName:
            - AttachUserPolicy
            - AttachGroupPolicy
            - AttachRolePolicy
            - PutUserPolicy
            - PutGroupPolicy
            - PutRolePolicy
    selection_admin_policy:
        requestParameters.policyArn|contains:
            - AdministratorAccess
            - PowerUserAccess
            - IAMFullAccess
            - SecurityAudit
    selection_create_policy_version:
        eventSource: iam.amazonaws.com
        eventName: CreatePolicyVersion
    selection_update_assume_role:
        eventSource: iam.amazonaws.com
        eventName: UpdateAssumeRolePolicy
    selection_permission_boundary:
        eventSource: iam.amazonaws.com
        eventName:
            - DeleteUserPermissionsBoundary
            - DeleteRolePermissionsBoundary
            - PutUserPermissionsBoundary
            - PutRolePermissionsBoundary
    selection_create_access_key:
        eventSource: iam.amazonaws.com
        eventName: CreateAccessKey
    filter_aws_service:
        userIdentity.invokedBy|contains:
            - amazonaws.com
            - cloudformation.amazonaws.com
    condition: (selection_attach_policy and selection_admin_policy) or selection_create_policy_version or selection_update_assume_role or selection_permission_boundary or (selection_create_access_key and not filter_aws_service)
falsepositives:
    - Legitimate IAM administration by authorized personnel
    - Infrastructure as Code deployments (Terraform, CloudFormation)
    - Automated IAM provisioning systems
level: high
