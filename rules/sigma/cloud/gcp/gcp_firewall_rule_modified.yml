title: GCP Firewall Rule Modified to Allow Ingress
id: c3d4e5f6-3333-4000-8000-000000000003
status: stable
description: |
    Detects creation or modification of VPC firewall rules that allow ingress
    traffic, especially from any source (0.0.0.0/0). Open firewall rules can
    expose internal services to the internet.
references:
    - https://attack.mitre.org/techniques/T1562/007/
    - https://cloud.google.com/vpc/docs/firewalls
    - https://cloud.google.com/architecture/security-best-practices
author: Defensive Toolkit
date: 2025-12-28
modified: 2025-12-28
tags:
    - attack.defense_evasion
    - attack.t1562.007
    - detection.cloud_threats
    - cloud.gcp
logsource:
    product: gcp
    service: cloudaudit
detection:
    selection_firewall_create:
        protoPayload.methodName:
            - v1.compute.firewalls.insert
            - v1.compute.firewalls.update
            - v1.compute.firewalls.patch
            - beta.compute.firewalls.insert
            - beta.compute.firewalls.update
    selection_ingress:
        protoPayload.request.direction: INGRESS
    selection_allow_all:
        protoPayload.request.sourceRanges|contains: '0.0.0.0/0'
    selection_sensitive_ports:
        protoPayload.request.allowed.ports|contains:
            - '22'
            - '23'
            - '3389'
            - '5432'
            - '3306'
            - '27017'
            - '6379'
    condition: selection_firewall_create and selection_ingress and (selection_allow_all or selection_sensitive_ports)
falsepositives:
    - Public-facing load balancer configuration
    - Web server firewall rules (ports 80, 443)
    - Development environment setup
level: high
