title: GCP Logging Sink or Audit Configuration Modified
id: c3d4e5f6-3333-4000-8000-000000000004
status: stable
description: |
    Detects modifications to GCP Cloud Logging sinks or audit log configurations.
    Attackers may modify logging to evade detection or redirect logs to
    attacker-controlled destinations.
references:
    - https://attack.mitre.org/techniques/T1562/008/
    - https://cloud.google.com/logging/docs/routing/overview
    - https://cloud.google.com/logging/docs/audit
author: Defensive Toolkit
date: 2025-12-28
modified: 2025-12-28
tags:
    - attack.defense_evasion
    - attack.t1562.008
    - detection.cloud_threats
    - cloud.gcp
logsource:
    product: gcp
    service: cloudaudit
detection:
    selection_sink_operations:
        protoPayload.methodName:
            - google.logging.v2.ConfigServiceV2.CreateSink
            - google.logging.v2.ConfigServiceV2.UpdateSink
            - google.logging.v2.ConfigServiceV2.DeleteSink
    selection_exclusion_operations:
        protoPayload.methodName:
            - google.logging.v2.ConfigServiceV2.CreateExclusion
            - google.logging.v2.ConfigServiceV2.UpdateExclusion
    selection_audit_config:
        protoPayload.methodName|contains:
            - SetIamPolicy
        protoPayload.request.policy.auditConfigs: '*'
    condition: selection_sink_operations or selection_exclusion_operations or selection_audit_config
falsepositives:
    - Legitimate logging infrastructure changes
    - Log routing optimization
    - Audit configuration compliance updates
level: medium
