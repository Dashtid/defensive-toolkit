title: GCP Service Account Key Creation
id: c3d4e5f6-3333-4000-8000-000000000001
status: stable
description: |
    Detects creation of service account keys in GCP. Service account keys are
    long-lived credentials that pose a security risk if compromised. Google
    recommends using workload identity federation instead of keys.
references:
    - https://attack.mitre.org/techniques/T1098/001/
    - https://cloud.google.com/iam/docs/service-account-creds
    - https://cloud.google.com/iam/docs/best-practices-for-managing-service-account-keys
author: Defensive Toolkit
date: 2025-12-28
modified: 2025-12-28
tags:
    - attack.persistence
    - attack.credential_access
    - attack.t1098.001
    - detection.cloud_threats
    - cloud.gcp
logsource:
    product: gcp
    service: cloudaudit
detection:
    selection_create_key:
        protoPayload.methodName:
            - google.iam.admin.v1.CreateServiceAccountKey
            - CreateServiceAccountKey
    selection_upload_key:
        protoPayload.methodName:
            - google.iam.admin.v1.UploadServiceAccountKey
            - UploadServiceAccountKey
    condition: selection_create_key or selection_upload_key
falsepositives:
    - Legitimate service account provisioning
    - CI/CD pipeline setup
    - Third-party integration requirements
level: medium
