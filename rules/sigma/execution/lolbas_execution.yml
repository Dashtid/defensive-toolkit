title: LOLBAS Binary Execution with Suspicious Arguments
id: a1b2c3d4-3333-4444-aaaa-333333333333
status: stable
description: |
    Detects execution of Living Off The Land Binaries and Scripts (LOLBAS)
    with suspicious command-line arguments. These are legitimate Windows
    binaries abused by attackers for code execution, download, or bypass.
references:
    - https://attack.mitre.org/techniques/T1218/
    - https://lolbas-project.github.io/
    - https://www.ibm.com/thought-leadership/institute-business-value/en-us/report/2025-threat-intelligence-index
author: Defensive Toolkit
date: 2025-11-26
modified: 2025-11-26
tags:
    - attack.execution
    - attack.defense_evasion
    - attack.t1218
    - detection.emerging_threats
logsource:
    category: process_creation
    product: windows
detection:
    selection_certutil:
        Image|endswith: '\certutil.exe'
        CommandLine|contains:
            - '-urlcache'
            - '-decode'
            - '-encode'
            - '-decodehex'
            - '/urlcache'
            - '/decode'
    selection_bitsadmin:
        Image|endswith: '\bitsadmin.exe'
        CommandLine|contains:
            - '/transfer'
            - '/create'
            - '/addfile'
            - '/SetNotifyCmdLine'
    selection_rundll32:
        Image|endswith: '\rundll32.exe'
        CommandLine|contains:
            - 'javascript:'
            - 'http://'
            - 'https://'
            - ',RunHTMLApplication'
            - 'shell32.dll,Control_RunDLL'
            - 'zipfldr.dll,RouteTheCall'
    selection_cscript_wscript:
        Image|endswith:
            - '\cscript.exe'
            - '\wscript.exe'
        CommandLine|contains:
            - 'http://'
            - 'https://'
            - '\\\\'
            - 'Temp'
            - 'AppData'
    selection_msiexec:
        Image|endswith: '\msiexec.exe'
        CommandLine|contains:
            - 'http://'
            - 'https://'
            - '/q'
    condition: 1 of selection_*
falsepositives:
    - Legitimate administrative use of these tools
    - Software deployment systems
    - Patch management tools
level: medium
